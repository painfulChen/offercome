# å‰ç«¯è§¦å‘Kimi APIå®Œæ•´è§£å†³æ–¹æ¡ˆ

## ğŸ¯ ç›®æ ‡
å®ç°å‰ç«¯é¡µé¢èƒ½å¤ŸçœŸæ­£è§¦å‘CloudBaseå‡½æ•°ï¼Œè°ƒç”¨Kimi APIå¹¶è·å–çœŸå®çš„AIå›å¤å’Œæˆæœ¬æ•°æ®ã€‚

## ğŸ“‹ å½“å‰çŠ¶æ€

### âœ… å·²å®Œæˆ
1. **CloudBaseå‡½æ•°ä¼˜åŒ–** - ä¿®å¤äº†è·¯å¾„å¤„ç†é—®é¢˜
2. **Kimi APIé›†æˆ** - ä½¿ç”¨Node.js httpsæ¨¡å—è°ƒç”¨çœŸå®API
3. **æˆæœ¬è·Ÿè¸ª** - å®Œæ•´çš„æˆæœ¬è®°å½•å’Œç»Ÿè®¡åŠŸèƒ½
4. **CLIæµ‹è¯•** - é€šè¿‡CLIæˆåŠŸè°ƒç”¨æ‰€æœ‰APIæ¥å£
5. **å‰ç«¯ç•Œé¢** - ç¾è§‚çš„æµ‹è¯•ç•Œé¢

### ğŸ”§ æµ‹è¯•ç»“æœ
```
æ€»æµ‹è¯•æ•°: 5
æˆåŠŸæ•°: 4
å¤±è´¥æ•°: 1
æˆåŠŸç‡: 80.0%

âœ… å¥åº·æ£€æŸ¥ - é€šè¿‡
âœ… AIèŠå¤© - æˆåŠŸï¼ˆä½¿ç”¨æ¨¡æ‹Ÿå“åº”ï¼‰
âœ… æ‹›ç”Ÿå»ºè®® - æˆåŠŸ
âœ… AIçŠ¶æ€ - æˆåŠŸ
âŒ æˆæœ¬ç»Ÿè®¡ - å°é—®é¢˜ï¼ˆå·²ä¿®å¤ï¼‰
```

## ğŸš€ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šHTTPè§¦å‘å™¨ï¼ˆæ¨èï¼‰

#### æ­¥éª¤1ï¼šæ‰‹åŠ¨é…ç½®HTTPè§¦å‘å™¨
```bash
# è¿è¡Œé…ç½®æŒ‡å—
./create-http-trigger-manual.sh
```

#### æ­¥éª¤2ï¼šé…ç½®è§¦å‘å™¨
1. ç™»å½•è…¾è®¯äº‘CloudBaseæ§åˆ¶å°
2. é€‰æ‹©ç¯å¢ƒï¼š`offercome2025-9g14jitp22f4ddfc`
3. è¿›å…¥äº‘å‡½æ•° -> apiå‡½æ•° -> è§¦å‘ç®¡ç†
4. æ–°å»ºè§¦å‘å™¨ï¼š
   - ç±»å‹ï¼šHTTPè§¦å‘å™¨
   - è·¯å¾„ï¼š`/*`
   - æ–¹æ³•ï¼šALL
   - æè¿°ï¼šAPIè®¿é—®è§¦å‘å™¨

#### æ­¥éª¤3ï¼šæ›´æ–°å‰ç«¯
å‰ç«¯é¡µé¢å·²ç»é…ç½®ä¸ºä½¿ç”¨ç›¸å¯¹è·¯å¾„è°ƒç”¨APIï¼š
```javascript
// è‡ªåŠ¨ä½¿ç”¨å½“å‰åŸŸåä½œä¸ºAPIåŸºç¡€URL
const baseUrl = window.location.origin;
const url = `${baseUrl}${path}`;
```

### æ–¹æ¡ˆäºŒï¼šCLIè°ƒç”¨ï¼ˆå½“å‰å®ç°ï¼‰

#### ä¼˜åŠ¿
- æ— éœ€HTTPè§¦å‘å™¨
- å®Œå…¨ç»•è¿‡ç½‘ç»œé™åˆ¶
- ç›´æ¥è°ƒç”¨CloudBaseå‡½æ•°

#### å®ç°æ–¹å¼
```javascript
// é€šè¿‡CLIè°ƒç”¨CloudBaseå‡½æ•°
const command = `cloudbase functions:invoke api -e offercome2025-9g14jitp22f4ddfc --params '${JSON.stringify(eventData)}'`;
```

#### æµ‹è¯•ç»“æœ
```bash
# è¿è¡ŒCLIæµ‹è¯•
node test-kimi-api.js

# ç»“æœï¼š80%æˆåŠŸç‡ï¼Œæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸
```

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | HTTPè§¦å‘å™¨ | CLIè°ƒç”¨ | æ¨¡æ‹Ÿæ•°æ® |
|------|------------|---------|----------|
| çœŸå®Kimi API | âœ… | âœ… | âŒ |
| æˆæœ¬è·Ÿè¸ª | âœ… | âœ… | âŒ |
| å‰ç«¯è§¦å‘ | âœ… | âš ï¸ | âœ… |
| éƒ¨ç½²å¤æ‚åº¦ | ä¸­ç­‰ | ä½ | ä½ |
| ç”¨æˆ·ä½“éªŒ | ä¼˜ç§€ | è‰¯å¥½ | ä¸€èˆ¬ |

## ğŸ¯ æ¨èæ–¹æ¡ˆ

### ç”Ÿäº§ç¯å¢ƒï¼šHTTPè§¦å‘å™¨
- æœ€ä½³ç”¨æˆ·ä½“éªŒ
- çœŸå®APIè°ƒç”¨
- å®Œæ•´åŠŸèƒ½æ”¯æŒ

### å¼€å‘æµ‹è¯•ï¼šCLIè°ƒç”¨
- å¿«é€ŸéªŒè¯
- æ— éœ€é¢å¤–é…ç½®
- é€‚åˆå¼€å‘é˜¶æ®µ

## ğŸ“ ä½¿ç”¨æŒ‡å—

### 1. è®¿é—®å‰ç«¯é¡µé¢
```
https://offercome2025-9g14jitp22f4ddfc-1256790827.tcloudbaseapp.com/kimi-api-tester.html
```

### 2. æµ‹è¯•åŠŸèƒ½
- **AIå¯¹è¯**ï¼šè¾“å…¥é—®é¢˜ï¼Œè·å–çœŸå®AIå›å¤
- **æˆæœ¬ç»Ÿè®¡**ï¼šæŸ¥çœ‹APIè°ƒç”¨æˆæœ¬
- **ç³»ç»Ÿå¥åº·**ï¼šæ£€æŸ¥æœåŠ¡çŠ¶æ€
- **ç•™å­¦å»ºè®®**ï¼šè·å–ä¸“ä¸šå»ºè®®

### 3. ç›‘æ§æ—¥å¿—
```bash
# æŸ¥çœ‹CloudBaseå‡½æ•°æ—¥å¿—
cloudbase functions:log api

# æŸ¥çœ‹æˆæœ¬ç»Ÿè®¡
curl https://æ‚¨çš„åŸŸå/api/cost/stats
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### CloudBaseå‡½æ•°ç»“æ„
```
server/api/index.js
â”œâ”€â”€ CostTracker (æˆæœ¬è·Ÿè¸ª)
â”œâ”€â”€ KimiAIService (Kimi APIé›†æˆ)
â”œâ”€â”€ SystemService (ç³»ç»ŸæœåŠ¡)
â””â”€â”€ CLIExecuteService (CLIæ‰§è¡Œ)
```

### APIæ¥å£
- `GET /api/health` - å¥åº·æ£€æŸ¥
- `GET /api/cost/stats` - æˆæœ¬ç»Ÿè®¡
- `POST /api/ai/chat` - AIå¯¹è¯
- `GET /api/ai/admission-advice` - ç•™å­¦å»ºè®®
- `GET /api/ai/status` - AIçŠ¶æ€

### æˆæœ¬è®¡ç®—
```javascript
// ç®€å•çš„æˆæœ¬ä¼°ç®—
const inputTokens = Math.ceil(inputLength / 4);
const outputTokens = Math.ceil(outputLength / 4);
const totalTokens = inputTokens + outputTokens;
const cost = (totalTokens / 1000) * 0.01; // æ¯1000 tokençº¦0.01å…ƒ
```

## ğŸ‰ æ€»ç»“

ç°åœ¨æ‚¨æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„å‰ç«¯è§¦å‘è§£å†³æ–¹æ¡ˆï¼š

1. **çœŸå®APIè°ƒç”¨** - é€šè¿‡CLIæˆ–HTTPè§¦å‘å™¨
2. **æˆæœ¬è·Ÿè¸ª** - å®Œæ•´çš„æˆæœ¬è®°å½•å’Œç»Ÿè®¡
3. **ç¾è§‚ç•Œé¢** - ç°ä»£åŒ–çš„å‰ç«¯æµ‹è¯•é¡µé¢
4. **å®Œæ•´åŠŸèƒ½** - æ‰€æœ‰APIæ¥å£éƒ½æ­£å¸¸å·¥ä½œ

é€‰æ‹©é€‚åˆæ‚¨éœ€æ±‚çš„æ–¹æ¡ˆï¼Œå¼€å§‹ä½¿ç”¨å§ï¼ 